<div class="sicodis-container">
  
  <!-- Popups para Diccionario y Siglas -->
  <app-info-popup 
    [infoText]="diccionarioContent" 
    contentTitle="Diccionario de Conceptos"
    [showPopup]="showDiccionarioPopup"
    (onClose)="closeDiccionarioPopup()">
  </app-info-popup>
  
  <app-info-popup 
    [infoText]="siglasContent" 
    contentTitle="Siglas y Abreviaciones"
    [showPopup]="showSiglasPopup"
    (onClose)="closeSiglasPopup()">
  </app-info-popup>

  <!-- Banner -->
  <div class="gradient-banner">    
    <div class="gradient-overlay"></div>
    <div class="banner-content">
      <h1>SGR Montos Corrientes y Constantes</h1>
        <p>Consulte información sobre los montos presupuestales y de recaudo del Sistema General de Regalías en valores corrientes y constantes a través del tiempo.</p>
    </div>
  </div>

  <!-- Sección de botones Diccionario y Siglas -->
  <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 0;">
    <div style="width: 83%;">
      <p class="date-update">Fecha de actualización: junio 30 de 2025</p>
      <p class="date-update">Fecha de corte de recaudo: mayo 30 de 2025</p>
    </div>
    <div style="position: relative; padding-bottom: .25rem;">
      <button pButton type="button" label="Diccionario" class="p-button-secondary" style="margin-right: 1.8rem; width: 96px;"
          (click)="showPopupDiccionario()">
      </button>
      <button pButton type="button" label="Siglas" class="p-button-secondary" style="width: 90px;"
          (click)="showPopupSiglas()">
      </button>
    </div> 
  </div>

  <!-- Charts section -->
  <div class="graphics-section">
    <h2 class="charts-main-title">Evolución histórica de Presupuesto y Recaudo SGR</h2>
    <div class="dual-chart-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; width: 100%;">
      <!-- First Chart - Valores Corrientes -->
      <div class="chart-column">
        <p-card class="chart-card">
          <ng-template pTemplate="header">
            <div style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center;">
              <h3 class="chart-title">Presupuesto y Recaudo en valores corrientes</h3>
            </div>
          </ng-template>
          <div class="chart-container" style="position: relative; height: 320px; width: 100%;">
            <p-chart 
            type="bar" 
            [data]="valoresCorrientesChartData" 
            [options]="valoresCorrientesChartOptions"
            width="570px"
            height="300px">
          </p-chart>
          </div>
        </p-card>
      </div>

      <!-- Second Chart - Valores Constantes -->
      <div class="chart-column">
        <p-card class="chart-card">
          <ng-template pTemplate="header">
            <div style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center;">
              <h3 class="chart-title">Presupuesto y Recaudo en valores constantes</h3>
            </div>
          </ng-template>
          <div class="chart-container" style="position: relative; height: 320px; width: 100%;">
            <p-chart 
            type="bar" 
            [data]="valoresConstantesChartData" 
            [options]="valoresConstantesChartOptions"
            width="570px"
            height="300px">
          </p-chart>
          </div>
        </p-card>
      </div>
    </div>
  </div>

  <!-- Table section -->
  <div class="table-section">
    <div class="table-header" style="text-align: center; margin-bottom: 1.5rem;">
      <h2 style="font-family: 'Work Sans', sans-serif; font-size: 1.5rem; font-weight: 700; color: #004583; margin: 0; padding: 0;">Presupuesto y Recaudo en valores corrientes y constantes</h2>
    </div>
    
    <div style="overflow-x: auto;">
      <p-table [value]="presupuestoRecaudoTableData" 
               styleClass="p-datatable-sm presupuesto-recaudo-table">
               
        <!-- Grouped headers -->
        <ng-template pTemplate="header">
          <tr>
            <th rowspan="2" class="vigencia-header">Vigencia</th>
            <th colspan="3" class="group-header presupuesto-header" style="text-align: center;">Presupuesto</th>
            <th colspan="3" class="group-header recaudo-header" style="text-align: center;">Recaudo</th>
          </tr>
          <tr>
            <!-- Presupuesto sub-headers -->
            <th class="sub-header presupuesto-sub">Valores Corrientes</th>
            <th class="sub-header presupuesto-sub">Valores Constantes</th>
            <th class="sub-header presupuesto-sub">% Variación</th>
            <!-- Recaudo sub-headers -->
            <th class="sub-header recaudo-sub">Valores Corrientes</th>
            <th class="sub-header recaudo-sub">Valores Constantes</th>
            <th class="sub-header recaudo-sub">% Variación</th>
          </tr>
        </ng-template>
        
        <!-- Data rows -->
        <ng-template pTemplate="body" let-rowData>
          <tr>
            <td class="vigencia-cell">{{rowData.vigencia}}</td>
            <!-- Presupuesto data -->
            <td class="number-cell" style="text-align: right;">{{rowData.presupuesto_corrientes | numberFormat}}</td>
            <td class="number-cell" style="text-align: right;">{{rowData.presupuesto_constantes | numberFormat}}</td>
            <td class="percentage-cell" style="text-align: right;">{{rowData.presupuesto_variacion | number:'1.1-1'}}%</td>
            <!-- Recaudo data -->
            <td class="number-cell" style="text-align: right;">{{rowData.recaudo_corrientes | numberFormat}}</td>
            <td class="number-cell" style="text-align: right;">{{rowData.recaudo_constantes | numberFormat}}</td>
            <td class="percentage-cell" style="text-align: right;">{{rowData.recaudo_variacion | number:'1.1-1'}}%</td>
          </tr>
        </ng-template>
        
      </p-table>
    </div>

    <!-- Export button -->
    <div class="table-actions" style="text-align: center; margin: 1.5rem 0;">
      <button pButton type="button" 
              icon="pi pi-file-excel" 
              label="Descargar Excel" 
              class="p-button-primary export-btn"
              (click)="downloadExcel()">
      </button>
    </div>

    <!-- Notes section -->
    <div class="notes-section" style="margin-top: 2rem; padding: 1rem; background-color: #f8f9fa; border-radius: 8px; border-left: 4px solid #0056b3;">
      <h3 style="font-size: 1.1rem; font-weight: 600; margin-bottom: 0.5rem; color: #333;">Notas</h3>
      <p style="font-size: 0.9rem; margin: 0; color: #555;">Valores de IPC y deflactores – DPIP 2025.</p>
    </div>
  </div>

</div>