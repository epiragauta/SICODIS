<div class="sicodis-container">

  <p-splitter [panelSizes]="[80, 20]" [style]="{ height: '530px' }" styleClass="mb-8">
    <ng-template pTemplate="panel">
        <div class="tree-table-container">
          <p-treetable [value]="data"
                        [columns]="cols"
                        [paginator]="true"
                        showGridlines
                        [rows]="20"
                        [scrollable]="true"
                        scrollHeight="510spx"
                        selectionMode="single"
                        [(selection)]="selectedNode"
                        styleClass="p-treetable-sm"
                        [resizableColumns]="true"
                        columnResizeMode="expand">

            <ng-template pTemplate="caption">
              <div class="caption-container">
                <h2 class="reports-title">Propuesta Resumen SGR</h2>
                <p class="instruction-text">
                    Haga clic en el encabezado "Presupuesto Otros" para ver el detalle de las fuentes
                  </p>
              </div>
            </ng-template>

            <ng-template pTemplate="colgroup" let-columns>
              <colgroup>
                <col *ngFor="let col of columns" [style.width]="col.width">
              </colgroup>
            </ng-template>

            <ng-template pTemplate="header" let-columns>
              <tr>
                <th *ngFor="let col of columns"
                    [ngStyle]="{'width': col.width, 'backgroundColor': col.color}"
                    [ngClass]="[col.field === 'presupuesto_otros' ? 'expandable-column' : '',
                                col.class ? col.class : '']"
                    (click)="col.field === 'presupuesto_otros' ? toggleColumns() : null">
                  {{col.header}}
                  <span *ngIf="col.field === 'presupuesto_otros'" class="toggle-icon">
                    {{isExpanded ? '(-)' : '(+)'}}
                  </span>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowNode let-rowData="rowData">
                <tr [ttRow]="rowNode" [ttSelectableRow]="rowNode">
                  <td *ngFor="let col of cols"
                    [ngClass]="[col.field === 'presupuesto_otros' ? 'expandable-column' : '',
                                col.class ? col.class : '']">
                    <p-treeTableToggler [rowNode]="rowNode" *ngIf="col.field === 'concepto'"></p-treeTableToggler>
                    <ng-container [ngSwitch]="col.field">
                      <ng-container *ngSwitchCase="'concepto'">
                        <span [ngClass]="{'font-bold': rowNode.level <= 1,
                                          'expandable-column': col.field === 'presupuesto_otros',
                                          'col-style': col.field === 'presupuesto_otros' && col.class}">
                          {{rowData.categoria ? rowData.categoria + ' - ' : ''}}{{rowData.concepto}}
                        </span>
                      </ng-container>

                      <ng-container *ngSwitchCase="'porcentaje_1'">
                        <div [ngClass]="{'font-bold': rowNode.level <= 1}">
                          {{formatPercentage(rowData[col.field])}}
                        </div>

                      </ng-container>

                      <ng-container *ngSwitchCase="'porcentaje_2'">
                        <div [ngClass]="{'font-bold': rowNode.level <= 1}">
                          {{formatPercentage(rowData[col.field])}}
                        </div>
                      </ng-container>

                      <ng-container *ngSwitchDefault>
                        <div [ngClass]="{'font-bold': rowNode.level <= 1, 'col-style': col.field === 'presupuesto_otros' && col.class}" class="text-right"
                            *ngIf="rowData[col.field] !== null && rowData[col.field] !== undefined">
                          {{formatCurrency(rowData[col.field])}}
                        </div>
                        <div class="text-right no-data" *ngIf="rowData[col.field] === null || rowData[col.field] === undefined">
                          -
                        </div>
                      </ng-container>
                    </ng-container>
                  </td>
                </tr>
              </ng-template>

          </p-treetable>
        </div>
    </ng-template>
    <ng-template pTemplate="panel">
        
        <div class="flex items-center justify-center h-full" style="overflow: auto;">
          <p>Información detallada sobre presupuestos, recaudos y distribución de recursos del Sistema General de Regalías de Colombia, organizada jerárquicamente por diferentes conceptos presupuestales.</p>
          
          <br>
          <ul>
            <li><strong>Concepto</strong>: Descripción de la categoría presupuestal</li>
            <li><strong>Presupuesto corriente</strong>: Monto presupuestado para ingresos corrientes</li>
            <li><strong>Presupuesto otros</strong>: Montos presupuestados para otras fuentes de ingreso</li>
            <li><strong>Presupuesto total vigente</strong>: Suma total del presupuesto vigente (corriente + otros)</li>
            <li><strong>Caja corriente informada</strong>: Valores de caja reportados para los ingresos corrientes</li>
            <li><strong>Caja total</strong>: Monto total de caja</li>
            <li><strong>Disponibilidad inicial</strong>: Recursos disponibles al inicio del periodo</li>
            <li><strong>Excedentes faep fonpet</strong>: Excedentes provenientes del Fondo de Ahorro y Estabilización (FAE) y del Fondo de Pensiones Territoriales (FONPET)</li>
            <li><strong>Mineral sin identificacion de origen</strong>: Ingresos provenientes de minerales cuyo origen no está identificado</li>
            <li><strong>MR</strong>: Categoría específica de ingresos</li>
            <li><strong>Multas</strong>: Ingresos provenientes de sanciones o penalidades</li>
            <li><strong>Reintegros</strong>: Devoluciones o retornos de recursos</li>
            <li><strong>Rendimientos financieros</strong>: Ingresos generados por rendimientos de inversiones</li>
            <li><strong>Porcentaje 1</strong> y <strong>Porcentaje 2</strong>: Indicadores porcentuales que miden proporciones entre valores</li>
          </ul>
          <h3>Estructura de conceptos principales:</h3>
          <ul>
            <li>TOTAL</li>
            <li>INVERSIÓN
              <ul>
                <li>Asignaciones Directas 20%</li>
                <li>Asignación para la Inversión Regional</li>
                <li>Asignación para la Inversión Local</li>
                <li>Asignación para Ciencia, Tecnología e Innovación</li>
                <li>Asignación para la Paz</li>
                <li>Asignación Ambiental</li>
                <li>Municipios Río Magdalena y Canal Dique</li>
                <li>Emprendimiento</li>
                <li>Incentivo a la producción</li>
              </ul>
            </li>
            <li>AHORRO
              <ul>
                <li>Fondo de Ahorro y Estabilización (FAE)</li>
                <li>Fondo Ahorro Pensional Territorial (FONPET)</li>
              </ul>
            </li>
            <li>OTROS
              <ul>
                <li>Funcionamiento</li>
                <li>Fiscalización</li>
                <li>Sistema de Seguimiento, Evaluación y Control (SSEC)</li>
              </ul>
            </li>
            <li>RECAUDO CORRIENTE NO AFORADO</li>
          </ul>

          <p>Los valores monetarios están expresados en pesos colombianos y representan cifras considerables (en el orden de billones de pesos), correspondientes al presupuesto nacional del Sistema General de Regalías.</p>
        </div>
    </ng-template>
</p-splitter>

  

</div>
